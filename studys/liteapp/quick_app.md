[华为快应用引擎技术架构详解](https://www.infoq.cn/article/huawei-quickapp-engine-architecture)

# 快应用如何做到秒开
Google 说页面打开时间超过3秒会刘帅用户13%, 超过6秒会流失60%
快应用从用户点击到首页完全展示需要2秒+
快应用启动流程:
  用户首次点击快应用图标 -> 触发包下载, 同时初始化快应用引擎 ->
  当整包下载并校验完成后, 首页的 Js 组件开始执行 -> 并开始渲染 ->
  快应用 Js 的框架代码执行, 计算组件模板布局, 生成原生 UI 控件 ->
  其中组件内逻辑执行中会有数据驱动下的页面再渲染, 直至首屏内容完全展示

## 流式加载
这个过程中 下载包 是瓶颈, 正常网络下载一个 2M 的包需要 2s 以上

快应用引入了 (有点像离线包加载的) 流式加载方式以减少包下载延时
怎么做到呢? 其实就是拆包, 把首页需要的资源优先传输, 并先进行解压与校验
启动和展示首页所需资源比较固定(公共代码, 全局配置文件, 首页 Js 文件与所需要的 图片等)

在应用启动后会继续下载其他资源, 如果访问到了某一个未下载资源, 则优先下载它

原始的应用签名方式是对整包进行签名, 那么就只能等整个包下载后才能校验, 与上述方案矛盾
快应用引入二级校验方式, 对整包的不同片段包单独生成一个 hash 值,
将所有的 hash 值拼接成一个 hash 文件, 对该 hash 文件进行签名

下载时 hash 文件被优先传输, 传输完县校验 hash 文件, 之后每下载一个片段包后, 立即计算它的 hash 值,
并与 hash 文件中对应这个包的 hash 值进行对比, 一致则校验通过

## 快照
流式加载是对包下载过程的优化, 而首屏渲染过程也是可以优化的
首先, 在云端进行页面预渲染, 生成一个渲染的中间格式 - 快照
快照压缩后非常小, 可以作为快应用元数据发送到应用市场入口, 用户搜到它时, 快照就已经下载了

快应用引擎在请求下载快应用包的同时, 可以先加载快照, 渲染首屏, 等包下载完, 再在快照的基础之上进行一遍标准渲染流程
